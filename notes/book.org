#+TITLE: lua internals guide
#+AUTHOR: DreamAndDead
#+DATE: 2020-11-19
#+DESCRIPTION: a guide for reading lua source code

#+LATEX_COMPILER: xelatex
#+LATEX_CLASS: book
#+LATEX_CLASS_OPTIONS: [a4paper]
#+LATEX_HEADER: \usepackage{xeCJK}

#+HTML_DOCTYPE: html5


* overview

#+INCLUDE: "./overview.org"
  
* object

#+INCLUDE: "./object.org"

* memory

#+INCLUDE: "./mem.org"

* string

#+INCLUDE: "./string.org"

* table

#+INCLUDE: "./table.org"

* compiler

类比

opcode -> 机器码
vm -> 机器

将 lua 的执行过程分为编译时和运行时

考虑编译的过程

传统是 source -> token -> ast -> ir -> ... -> bytecode


lua 为了效率，直接从 source -> token -> bytecode
相应代码不是那么容易阅读
需要一些编译原理的了解

** lexer

#+INCLUDE: "./lexer.org"

** parser

#+INCLUDE: "./parser.org"

** opcode

#+INCLUDE: "./opcode.org"

** generate

#+INCLUDE: "./generate.org"

** dump & undump

#+INCLUDE: "./dump.org"

* vm

#+INCLUDE: "./vm.org"

* gc

#+INCLUDE: "./gc.org"

* debug

#+INCLUDE: "./debug.org"

* package module lib

#+INCLUDE: "./lib.org"

* error handling

#+INCLUDE: "./error.org"

* work with lua

#+INCLUDE: "./usage.org"


